<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 450">
  <style>
    .block { fill: #ebf2ff; stroke: #003366; stroke-width: 1.5; rx: 3; }
    .block-green { fill: #e6ffed; stroke: #28a745; stroke-width: 1.5; rx: 3; }
    .block-orange { fill: #fff5e6; stroke: #d97706; stroke-width: 1.5; rx: 3; }
    .attack { fill: #ffebee; stroke: #b71c1c; stroke-width: 1.5; rx: 3; font-style: italic; }
    .attack-dashed { fill: #fff3e0; stroke: #e65100; stroke-width: 1.5; stroke-dasharray: 4; rx: 3; font-style: italic; }
    .amp { fill: #f5f5f5; stroke: #9e9e9e; stroke-width: 1; stroke-dasharray: 3; rx: 3; }
    .text { font-family: sans-serif; font-size: 12px; text-anchor: middle; }
    .text-small { font-size: 10px; }
    .arrow { stroke: #003366; stroke-width: 2; fill: #003366; }
    .arrow-red { stroke: #b71c1c; stroke-width: 2; fill: #b71c1c; }
    .arrow-orange { stroke: #e65100; stroke-width: 2; fill: #e65100; stroke-dasharray: 4; }
  </style>

  <g transform="translate(20, 50)">
    <rect class="block" x="0" y="0" width="100" height="40" />
    <text class="text" x="50" y="18">Camera</text>
    <text class="text-small" x="50" y="32">(bus-mounted)</text>

    <line class="arrow" x1="100" y1="20" x2="130" y2="20" marker-end="url(#arrowhead)" />

    <rect class="block" x="135" y="0" width="100" height="40" />
    <text class="text" x="185" y="18">Detection</text>
    <text class="text-small" x="185" y="32">(YOLO)</text>

    <line class="arrow" x1="235" y1="20" x2="265" y2="20" />

    <rect class="block" x="270" y="0" width="100" height="40" id="node-reid" />
    <text class="text" x="320" y="18">ReID</text>
    <text class="text-small" x="320" y="32">Embedding</text>

    <line class="arrow" x1="370" y1="20" x2="400" y2="20" />

    <rect class="block" x="405" y="0" width="100" height="40" id="node-track" />
    <text class="text" x="455" y="18">Multi-Object</text>
    <text class="text-small" x="455" y="32">Tracking</text>

    <line class="arrow" x1="505" y1="20" x2="535" y2="20" />

    <rect class="block" x="540" y="0" width="100" height="40" />
    <text class="text" x="590" y="25">Counting Logic</text>

    <line class="arrow" x1="640" y1="20" x2="670" y2="20" />

    <rect class="block-green" x="675" y="0" width="100" height="40" id="node-out" />
    <text class="text" x="725" y="18">Output</text>
    <text class="text-small" x="725" y="32">{t, stop, dir, n}</text>
  </g>

  <g transform="translate(20, 50)">
    <line class="arrow-red" x1="320" y1="40" x2="320" y2="75" />
    <rect class="attack" x="270" y="80" width="100" height="35" />
    <text class="text" x="320" y="95">A1: Embeddings</text>
    <text class="text-small" x="320" y="108">extraction</text>
    <rect class="amp" x="260" y="125" width="120" height="40" />
    <text class="text-small" x="320" y="140">Weak device security;</text>
    <text class="text-small" x="320" y="155">3rd-party maintenance</text>

    <line class="arrow-red" x1="455" y1="40" x2="455" y2="75" />
    <rect class="attack" x="405" y="80" width="100" height="35" />
    <text class="text-small" x="455" y="100">A2: Failure-mode exploitation</text>
    <rect class="amp" x="395" y="125" width="120" height="40" />
    <text class="text-small" x="455" y="140">Ghost injection;</text>
    <text class="text-small" x="455" y="155">ID fragmentation</text>

    <line class="arrow-red" x1="725" y1="40" x2="725" y2="75" />
    <rect class="attack" x="675" y="80" width="100" height="35" />
    <text class="text" x="725" y="95">A3: Metadata</text>
    <text class="text-small" x="725" y="108">correlation</text>
    <rect class="amp" x="665" y="125" width="120" height="40" />
    <text class="text-small" x="725" y="140">Sparse routes;</text>
    <text class="text-small" x="725" y="155">Fare payment linkage</text>
  </g>

  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#003366" />
    </marker>
  </defs>
</svg>
